\label{user-registration}
\subsubsection{Purpose}
Any user can subscribe through the web application or the mobile app. 

In both cases the user has to fill a registration form and must agree to the personal data policy according his/her country privacy laws, otherwise the registration request is denied.

As soon as the user has submitted all the data, the system verifies the consistency of the information and a confirmation mail is sent to check the availability of the user mail-address.  After this last check the registration ends successfully.

The system has two kind of registration forms (so two kind of registered users) one for passenger and one for taxi drivers.

The taxi driver registration is more restrictive and requires more user's information.
The system registers a user that claims to be a taxi driver only if he is able to demonstrate it with a currently valid taxi license.

% TODO: statechart

\subsubsection{Scenario 1}
Alice, a normal citizen without a car, has just discovered the existence of myTaxiService web application and she wants to use it. 
She opens the home of myTaxiService page on web and clicks on "passenger registration". 

She gives all the informations required and she authorises the personal data treatment. 

The system verifies the submitted information and sends a confirmation mail.
Alice checks the mailbox, opens the mail and clicks on the "confirm e-mail" link. 

The system informs Alice that the registration has ended with success.

\subsubsection{Scenario 2}
Bob is a taxi driver that wants to subscribe to myTaxiService application. 
He downloads the mobile application from his phone app-store and once he opens it, he selects "taxi driver registration". 
He fills the form, enters his licence ID and authorises the personal data treatment.

However he forgets to write his phone number on the form so the system warns him about the forgetfulness.
Only after the complete and correct filling of the form, and the personal data treatment authorisation, the registration is one step near the successfully end.

The system verifies the informations submitted and sends a confirmation mail.
Bob checks the mailbox, opens the mail and clicks on "confirm e-mail". 

The system informs Bob that the registration has ended with success.

\subsubsection{Statechart}
The statechart is illustrated in figure \ref{fig:statechart-registration}.
\begin{figure}
\includegraphics[width=\textwidth]{diagrams/statechart_registration.pdf}
\caption{Statechart of the registration process.}
\label{fig:statechart-registration}
\end{figure}

\subsubsection{Associated functional requirements}

\begin{enumerate}
    \item On registration, the user can choose to register as a passenger or as a taxi driver.
    \item Passengers must provide the following information:
    \begin{itemize}
        \item e-mail address
        \item username 
        \item password
        \item name
        \item surname
        \item address (optional filling)
        \item phone number (optional filling)
    \end{itemize}
    \item Taxi drivers must provide the following information:
    \begin{itemize}
        \item e-mail address
        \item username 
        \item password
        \item name
        \item surname
        \item address 
        \item phone number
        \item taxi license ID
        \item taxi number-plate
    \end{itemize}
    \item There mustn't be another user already subscribed with the same username or e-mail.
    \item The username must match the regular expression\\``\texttt{[a-zA-Z][a-zA-Z0-9]\{2,20\}}''
    \item The system accepts a password that contains at least one number and one capital letter and that has a minimum length of eight characters.
    \item The system must ask for the password twice.
    \item The system accepts the password only if the same one is entered identically both times.
    \item If the personal data treatment is not authorised, the subscription is canceled.
    \item The system must allow the user to abort the registration process at any time.
    \item Email confirmation process:
    \begin{enumerate}
    \item The subscription ends successfully when the user clicks on the link in the confirmation e-mail.
    \item After two days without any answer, the systems sends another confirmation e-mail.
    \item After seven days user's registration info are deleted and the user may re-try the registration process.
   \end{enumerate}
\end{enumerate}

